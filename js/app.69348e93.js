(function(t){function e(e){for(var o,l,i=e[0],u=e[1],s=e[2],f=0,d=[];f<i.length;f++)l=i[f],a[l]&&d.push(a[l][0]),a[l]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);c&&c(e);while(d.length)d.shift()();return r.push.apply(r,s||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,i=1;i<n.length;i++){var u=n[i];0!==a[u]&&(o=!1)}o&&(r.splice(e--,1),t=l(l.s=n[0]))}return t}var o={},a={app:0},r=[];function l(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=t,l.c=o,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)l.d(n,o,function(e){return t[e]}.bind(null,o));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var s=0;s<i.length;s++)e(i[s]);var c=u;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._v("\n\t风险分类台账:"),n("input",{attrs:{type:"file",accept:".xls,.xlsx",name:""},on:{change:function(e){return t.handleFileUpload(1)}}}),t._v("\n\n    在库押品信息:"),n("input",{attrs:{type:"file",accept:".xls,.xlsx",name:"在库押品信息"},on:{change:function(e){return t.handleFileUpload(2)}}}),n("button",{on:{click:function(e){return t.donload()}}},[t._v("下载")]),n("pre",[t._v(t._s(t.formattedOutput))])])},r=[],l=(n("7514"),n("6d67"),n("f576"),n("6b54"),n("87b3"),{data:function(){return{table1Data:[],table2Data:[],formattedOutput:[],formattedDate:this.formatDate(new Date)}},methods:{formatDate:function(t){var e=t.getFullYear().toString(),n=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return"".concat(e).concat(n).concat(o)},donload:function(){var t=this.$xlsx.utils.json_to_sheet(this.formattedOutput),e=this.$xlsx.utils.book_new();this.$xlsx.utils.book_append_sheet(e,t,"Sheet1");var n=this.$xlsx.write(e,{bookType:"xlsx",type:"buffer"}),o=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(o),r=document.createElement("a");r.href=a,r.download="灵西支行在库押品"+this.formattedDate+".xlsx",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),document.body.removeChild(r)},handleFileUpload:function(t){var e=this,n=event.target.files[0];if(n){var o=new FileReader;o.onload=function(n){var o=n.target.result,a=e.$xlsx.read(o,{type:"binary"}),r=a.SheetNames[0],l=a.Sheets[r],i=e.$xlsx.utils.sheet_to_json(l,{header:1});1===t?e.table1Data=i:2===t&&(e.table2Data=i,e.getTable2Value(e.table1Data,i),e.reformatData())},o.readAsBinaryString(n)}},reformatData:function(){var t=this;this.table1Data.length&&this.table2Data.length?(this.formattedOutput=this.table1Data.map(function(e){return{"经办机构":"灵西支行","借款人客户号":e[2],"借款人名称":e[3],"合同编号":e[1],"合同金额(元)":e[15],"贷款余额(元)":e[7],"贷款五级分类2":(e[9]+"").substring(0,(e[9]+"").length-1)+"类","贷款五级分类":e[9],"担保方式":e[6],"抵质押物种类":"","押品类型":t.getTable2Value(e,2),"押品类型(小类)":t.getTable2Value(e,4),"抵质押人客户号":e[2],"抵质押人名称":e[3],"权利证书类型":t.getTable2Value(e,7),"评估金额（元）":t.getTable2Value(e,10),"设定权利金额（元）":t.getTable2Value(e,11),"经办人":t.getTable2Value1(e,15),"备注":""}}),console.log(this.formattedOutput)):console.error("Both tables must have data before formatting.")},getTable2Value1:function(t,e){var n=this.table2Data.find(function(e){return e[6]===t[3]&&e[11]===t[15]});return console.log("直接一次好"),void 0===n?(n=this.table2Data.find(function(e){return e[6]===t[3]}),void 0!==n?console.log("重新获取到"):console.log("第二次未获取到")):(n[6]+="1",console.log("修改值")),console.log(n),n?n[e]:""},getTable2Value:function(t,e){var n=this.table2Data.find(function(e){return e[6]===t[3]&&e[11]===t[15]});return console.log("直接一次好"),void 0===n&&(n=this.table2Data.find(function(e){return e[6]===t[3]}),void 0!==n?console.log("重新获取到"):console.log("第二次未获取到")),console.log(n),n?n[e]:""}},mounted:function(){this.reformatData()}}),i=l,u=n("2877"),s=Object(u["a"])(i,a,r,!1,null,null,null),c=s.exports,f=n("25ca");o["a"].config.productionTip=!1,o["a"].prototype.$xlsx=f,new o["a"]({render:function(t){return t(c)}}).$mount("#app")}});
//# sourceMappingURL=app.69348e93.js.map